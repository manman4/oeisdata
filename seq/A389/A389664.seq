%I A389664 #21 Oct 20 2025 03:00:42
%S A389664 1,5,3,1,2,3,5,2,1,3,7,5,4,11,3,1,4,13,9,7,2,5,19,4,1,5,21,3,11,9,11,
%T A389664 14,2,29,5,1,6,31,21,2,13,11,13,169,3,7,41,6,1,7,5,11,22,419,3,2,5,23,
%U A389664 461,27,8,55,7,1,2,3,49,29,11,5,17,15,17,3269,23
%N A389664 a(n) = 1 if n is a square, otherwise a(n) is the least integer m > 1 such that (m^2 - 1)*n + 1 is a square.
%C A389664 Conjecture: For any positive rational number r with sqrt(r) irrational, we have r = (m^2-1)/(n^2-1) for some integers m and n greater than one.
%C A389664 This conjecture implies that a(n) exists for all n > 0. Clearly, 4*(m^2-1) = n^2-1 (i.e. (2m)^2 - n^2 = 3) fails for any m,n = 2,3,....
%C A389664 Note that (2k+1)^2 - 1 = 8*T(k), where T(k) is the triangular number k*(k+1)/2.
%C A389664 After the author posed the conjecture to MathOverflow, Alexander Kalmynin provided a proof of the conjecture.
%H A389664 Chai Wah Wu, <a href="/A389664/b389664.txt">Table of n, a(n) for n = 1..10000</a> (terms 1..500 from Zhi-Wei Sun)
%H A389664 Zhi-Wei Sun, <a href="https://mathoverflow.net/questions/501454">On the sets {(m^2-1)/(n^2-1): m,n = 2,3,...} and {m(m+1)/(n(n+1)): m,n in Z^+}</a>, Question 501454 at MathOverflow, Oct. 10, 2025.
%e A389664 a(44) = 169 with (169^2-1)*44 + 1 = 1256641 = 1121^2.
%t A389664 SQ[n_]:=IntegerQ[Sqrt[n]];
%t A389664 tab={}; Do[If[SQ[n],tab=Append[tab,1];Goto[aa]];m=2;Label[bb];If[SQ[(m^2-1)n+1],tab=Append[tab,m];Goto[aa]];m=m+1;Goto[bb];Label[aa],{n,1,80}];Print[tab]
%o A389664 (PARI) a(n) = if (issquare(n), 1, my(m=2); while (!issquare((m^2-1)*n+1), m++); m); \\ _Michel Marcus_, Oct 11 2025
%o A389664 (Python)
%o A389664 from sympy.ntheory.primetest import is_square
%o A389664 from sympy.solvers.diophantine.diophantine import diop_DN
%o A389664 def A389664(n):
%o A389664     if is_square(n): return 1
%o A389664     c, a, b = None, diop_DN(n,1-n), diop_DN(n,1)
%o A389664     while c is None:
%o A389664         a2 = []
%o A389664         for r, s in a:
%o A389664             if (sa:=abs(s))>1:
%o A389664                 c = min(c,sa) if c is not None else sa
%o A389664             for t, u in b:
%o A389664                 w, d = r*u+s*t, r*t+s*u*n
%o A389664                 if (wa:=abs(w))>1:
%o A389664                     c = min(c,wa) if c is not None else wa
%o A389664                 a2.extend([(d,w),(d,-w),(-d,w),(-d,-w)])
%o A389664         a.extend(a2)
%o A389664     return c # _Chai Wah Wu_, Oct 16 2025
%Y A389664 Cf. A000217, A000290, A389657.
%K A389664 nonn,changed
%O A389664 1,2
%A A389664 _Zhi-Wei Sun_, Oct 10 2025
