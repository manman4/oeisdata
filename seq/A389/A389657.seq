%I A389657 #34 Oct 12 2025 16:14:30
%S A389657 0,3,1,0,3,1,3,15,0,1,6,3,6,15,1,0,78,21,10,6,1,3,45,190,0,3,55,1,15,
%T A389657 10,15,28203,45,105,3,0,465,120,55,3,21,15,21,3570,1,6,210,861,0,6,3,
%U A389657 15,105,21945,1,21,3,66,26565,91
%N A389657 a(n) is zero if n is a square, otherwise a(n) is the least triangular number m > 0 such that m*n is a triangular number.
%C A389657 Conjecture: Each positive rational number r with sqrt(r) irrational can be written as m*(m+1)/(n*(n+1)) = T(m)/T(n), where m and n are positive integers, and T(k) denotes the triangular number k*(k+1)/2.
%C A389657 This conjecture implies that a(n) exists for any positive integer n.
%C A389657 After the author posed the conjecture to MathOverflow, Alexander Kalmynin provided a proof of the conjecture.
%C A389657 For given nonsquare n, the smallest integer x > 1 is sought for which the generalized Pell equation z^2 - n*x^2 = 1 - n has an integer solution z. If such an x is found the corresponding triangular number is m = (x^2 - 1)/8. - _Peter Luschny_, Oct 10 2025
%H A389657 Chai Wah Wu, <a href="/A389657/b389657.txt">Table of n, a(n) for n = 1..10000</a> (terms 1..348 from Zhi-Wei Sun)
%H A389657 Alexander Kalmynin, <a href="https://mathoverflow.net/a/501457">Answer to Question 501457</a>, MathOverflow, Oct 2025.
%e A389657 a(14) = 15 with both 15 = 5*6/2 and 15*14 = 20*21/2 triangular numbers.
%e A389657 From _Peter Luschny_, Oct 10 2025: (Start):
%e A389657 Illustrating the Pell-Ansatz as described in the comment for n = 17. Search x = 3, 5, 7, ..., 25. So z = 17*25^2 + (1 - 17) = 10609 = 103^2 and m = (25^2 - 1) / 8 = 78. Thus a(17) = 78. (End)
%p A389657 A389657 := proc(n) local x, y, s;
%p A389657   if issqr(n) then return 0 fi;
%p A389657   s := false;
%p A389657   for x from 3 by 2 while not s do
%p A389657       y := x * x - 1;
%p A389657       s := issqr(n * y + 1);
%p A389657 od; iquo(y, 8) end:  # _Peter Luschny_, Oct 11 2025
%t A389657 SQ[n_]:=IntegerQ[Sqrt[n]];tab={}; Do[If[SQ[n],tab=Append[tab,0];Goto[aa]];k=1;Label[bb];m=k(k+1)/2;If[SQ[8m*n+1],tab=Append[tab,m];Goto[aa]];k=k+1;Goto[bb];Label[aa],{n,1,60}];Print[tab]
%o A389657 (Python)
%o A389657 import math
%o A389657 def is_square(n: int) -> bool:
%o A389657     if n < 0: return False
%o A389657     r = math.isqrt(n)
%o A389657     return r * r == n
%o A389657 def a(n: int) -> int:  # by solving a Pell equation
%o A389657     if is_square(n): return 0
%o A389657     x = 3
%o A389657     while True:
%o A389657         if is_square(n * x * x + (1 - n)):
%o A389657             d, m = divmod(x * x - 1, 8)
%o A389657             if m == 0: return d
%o A389657         x += 2
%o A389657 print([a(n) for n in range(1, 61)])  # _Peter Luschny_, Oct 10 2025
%o A389657 (Python)
%o A389657 from sympy.ntheory.primetest import is_square
%o A389657 from sympy.solvers.diophantine.diophantine import diop_DN
%o A389657 def A389657(n):
%o A389657     if is_square(n): return 0
%o A389657     c, a, b = None, diop_DN(n,1-n), diop_DN(n,1)
%o A389657     while c is None:
%o A389657         a2 = []
%o A389657         for r, s in a:
%o A389657             if (sa:=abs(s))>1 and sa&1:
%o A389657                 c = min(c,sa) if c is not None else sa
%o A389657             for t, u in b:
%o A389657                 w, d = r*u+s*t, r*t+s*u*n
%o A389657                 if (wa:=abs(w))>1 and wa&1:
%o A389657                     c = min(c,wa) if c is not None else wa
%o A389657                 a2.extend([(d,w),(d,-w),(-d,w),(-d,-w)])
%o A389657         a.extend(a2)
%o A389657     return c*c-1>>3 # _Chai Wah Wu_, Oct 11 2025
%Y A389657 Different from A227054 which is 1 at triangular numbers that are squares (A001110).
%Y A389657 Cf. A000217, A000290, A389664.
%K A389657 nonn,new
%O A389657 1,2
%A A389657 _Zhi-Wei Sun_, Oct 09 2025
