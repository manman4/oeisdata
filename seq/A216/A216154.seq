%I A216154 #23 Sep 22 2025 16:01:11
%S A216154 1,1,1,3,4,1,11,21,9,1,53,128,78,16,1,309,905,710,210,25,1,2119,7284,
%T A216154 6975,2680,465,36,1,16687,65821,74319,35035,7945,903,49,1,148329,
%U A216154 660064,857836,478464,133630,19936,1596,64,1,1468457,7275537,10690812,6879684,2279214,419958,44268,2628,81,1
%N A216154 Triangle read by rows, T(n,k) n>=0, k>=0, generalization of A000255.
%F A216154 Recurrence: T(0,0)=1, T(0,k)=0 for k>0 and for n>=1 T(n,k) = T(n-1,k-1)+(1+2*k)*T(n-1,k)+(k+1)*(k+2)*T(n-1,k+1).
%F A216154 Let Z(n, k) = Sum_{j=0..n} C(-j, -n)*L(j, k) where L denotes the unsigned Lah numbers A271703. Then T(n, k) = Z(n+1, k+1). - _Peter Luschny_, Apr 13 2016
%e A216154      1,
%e A216154      1,      1,
%e A216154      3,      4,      1,
%e A216154     11,     21,      9,      1,
%e A216154     53,    128,     78,     16,      1,
%e A216154    309,    905,    710,    210,     25,      1,
%e A216154   2119,   7284,   6975,   2680,    465,     36,      1,
%e A216154 16687,  65821,  74319,  35035,   7945,    903,     49,      1,
%e A216154 148329, 660064, 857836, 478464, 133630,  19936,   1596,     64,      1,
%p A216154 A216154 := proc(n,k) local L, Z;
%p A216154 L := (n,k) -> `if`(k<0 or k>n,0,(n-k)!*C(n,n-k)*C(n-1,n-k)):
%p A216154 Z := (n,k) -> add(C(-j,-n)*L(j,k), j=0..n);
%p A216154 Z(n+1, k+1) end:
%p A216154 seq(seq(A216154(n,k), k=0..n), n=0..9); # _Peter Luschny_, Apr 13 2016
%t A216154 T[0, 0] = 1; T[0, _] = 0; T[n_, k_] /; 0 <= k <= n := T[n, k] = T[n-1, k-1] + (2k+1) T[n-1, k] + (k+1) (k+2) T[n-1, k+1]; T[_, _] = 0;
%t A216154 Table[T[n, k], {n, 0, 9}, {k, 0, n}] // Flatten (* _Jean-FranÃ§ois Alcover_, Aug 02 2019 *)
%o A216154 (SageMath)
%o A216154 def A216154_triangle(dim):
%o A216154     M = matrix(ZZ,dim,dim)
%o A216154     for n in (0..dim-1): M[n,n] = 1
%o A216154     for n in (1..dim-1):
%o A216154         for k in (0..n-1):
%o A216154             M[n,k] = M[n-1,k-1]+(1+2*k)*M[n-1,k]+(k+1)*(k+2)*M[n-1,k+1]
%o A216154     return M
%o A216154 A216154_triangle(9)
%Y A216154 A000255 (col. 0), A110450 (diag. n,n-2).
%Y A216154 Cf. A111596, A271703.
%K A216154 nonn,tabl
%O A216154 0,4
%A A216154 _Peter Luschny_, Sep 19 2012
