%I A004016 M4042 #140 Sep 22 2025 16:00:18
%S A004016 1,6,0,6,6,0,0,12,0,6,0,0,6,12,0,0,6,0,0,12,0,12,0,0,0,6,0,6,12,0,0,
%T A004016 12,0,0,0,0,6,12,0,12,0,0,0,12,0,0,0,0,6,18,0,0,12,0,0,0,0,12,0,0,0,
%U A004016 12,0,12,6,0,0,12,0,0,0,0,0,12,0,6,12,0,0,12,0
%N A004016 Theta series of planar hexagonal lattice A_2.
%C A004016 The hexagonal lattice is the familiar 2-dimensional lattice in which each point has 6 neighbors. This is sometimes called the triangular lattice.
%C A004016 a(n) is the number of integer solutions to x^2 + x*y + y^2 = n (or equivalently x^2 - x*y + y^2 = n). - _Michael Somos_, Sep 20 2004
%C A004016 a(n) is the number of integer solutions to x^2 + y^2 + z^2 = 2*n where x + y + z = 0. - _Michael Somos_, Mar 12 2012
%C A004016 Ramanujan theta functions: f(q) (see A121373), phi(q) (A000122), psi(q) (A010054), chi(q) (A000700).
%C A004016 Cubic AGM theta functions: a(q) (the present sequence), b(q) (A005928), c(q) (A005882).
%C A004016 a(n) = 6*A002324(n) if n>0, and A002324 is multiplicative, thus a(1)*a(m*n) = a(n)*a(m) if n>0, m>0 are relatively prime. - _Michael Somos_, Mar 17 2019
%C A004016 The first occurrence of a(n)= 6, 12, 18, 24, ... (multiples of 6) is at n= 1, 7, 49, 91, 2401, 637, 117649, ... (see A002324). - _R. J. Mathar_, Sep 21 2024
%D A004016 B. C. Berndt, Ramanujan's Notebooks Part IV, Springer-Verlag, see p. 171, Entry 28.
%D A004016 Harvey Cohn, Advanced Number Theory, Dover Publications, Inc., 1980, p. 89. Ex. 18.
%D A004016 J. H. Conway and N. J. A. Sloane, "Sphere Packings, Lattices and Groups", Springer-Verlag, p. 111.
%D A004016 M. N. Huxley, Area, Lattice Points and Exponential Sums, Oxford, 1996; p. 236.
%D A004016 N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).
%H A004016 Seiichi Manyama, <a href="/A004016/b004016.txt">Table of n, a(n) for n = 0..10000</a> (terms 0..1000 from T. D. Noe)
%H A004016 S. Ahlgren, <a href="http://dx.doi.org/10.1090/S0002-9939-99-05181-3">The sixth, eighth, ninth and tenth powers of Ramanujan's theta function</a>, Proc. Amer. Math. Soc., 128 (1999), 1333-1338; F_3(q).
%H A004016 J. M. Borwein and P. B. Borwein, <a href="http://dx.doi.org/10.1090/S0002-9947-1991-1010408-0">A cubic counterpart of Jacobi's identity and the AGM</a>, Trans. Amer. Math. Soc., 323 (1991), no. 2, 691-701. MR1010408 (91e:33012) see page 695.
%H A004016 G. L. Hall, <a href="http://dx.doi.org/10.1063/1.527833">Comment on the paper "Theta series and magic numbers for diamond and certain ionic crystal structures" [J. Math. Phys. 28, 1653 (1987)]</a>. Journal of Mathematical Physics; Sep. 1988, Vol. 29 Issue 9, pp. 2090-2092. - From _N. J. A. Sloane_, Dec 18 2012
%H A004016 M. D. Hirschhorn, <a href="http://www.mat.univie.ac.at/~slc/wpapers/s42hirsch.html">Three classical results on representations of a number</a>, Séminaire Lotharingien de Combinatoire, B42f (1999), 8 pp.
%H A004016 Christian Kassel and Christophe Reutenauer, <a href="https://arxiv.org/abs/1505.07229v3">The zeta function of the Hilbert scheme of n points on a two-dimensional torus</a>, arXiv:1505.07229v3 [math.AG], 2015. [Note that a later version of this paper has a different title and different contents, and the number-theoretical part of the paper was moved to the publication which is next in this list.]
%H A004016 Christian Kassel and Christophe Reutenauer, <a href="https://arxiv.org/abs/1610.07793">Complete determination of the zeta function of the Hilbert scheme of n points on a two-dimensional torus</a>, arXiv:1610.07793 [math.NT], 2016.
%H A004016 Masao Koike, <a href="https://oeis.org/A004016/a004016.pdf">Modular forms on non-compact arithmetic triangle groups</a>, Unpublished manuscript [Extensively annotated with OEIS A-numbers by N. J. A. Sloane, Feb 14 2021. I wrote 2005 on the first page but the internal evidence suggests 1997.]
%H A004016 G. Nebe and N. J. A. Sloane, <a href="http://www.math.rwth-aachen.de/~Gabriele.Nebe/LATTICES/A2.html">Home page for hexagonal (or triangular) lattice A2</a>.
%H A004016 Helmut Ruhland, <a href="https://arxiv.org/abs/2410.16172">A family of lattices with an unbounded number of unit vectors</a>, arXiv:2410.16172 [math.MG], 2024. See p. 2.
%H A004016 N. J. A. Sloane et al., <a href="https://oeis.org/wiki/Binary_Quadratic_Forms_and_OEIS">Binary Quadratic Forms and OEIS</a> (Index to related sequences, programs, references).
%H A004016 N. J. A. Sloane, <a href="http://dx.doi.org/10.1109/TIT.1981.1056351">Tables of Sphere Packings and Spherical Codes</a>, IEEE Trans. Information Theory, vol. IT-27, 1981 pp. 327-338.
%H A004016 N. J. A. Sloane, <a href="http://dx.doi.org/10.1063/1.527472">Theta series and magic numbers for diamond and certain ionic crystal structures</a>, J. Math. Phys. 28 (1987), 1653-1657.
%H A004016 Michael Somos, <a href="/A010815/a010815.txt">Introduction to Ramanujan theta functions</a>.
%H A004016 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/RamanujanThetaFunctions.html">Ramanujan Theta Functions</a>.
%H A004016 <a href="/index/Aa#A2">Index entries for sequences related to A2 = hexagonal = triangular lattice</a>.
%F A004016 Expansion of a(q) in powers of q where a(q) is the first cubic AGM theta function.
%F A004016 Expansion of theta_3(q) * theta_3(q^3) + theta_2(q) * theta_2(q^3) in powers of q.
%F A004016 Expansion of phi(x) * phi(x^3) + 4 * x * psi(x^2) * psi(x^6) in powers of x where phi(), psi() are Ramanujan theta functions.
%F A004016 Expansion of (1 / Pi) integral_{0 .. Pi/2} theta_3(z, q)^3 + theta_4(z, q)^3 dz in powers of q^2. - _Michael Somos_, Jan 01 2012
%F A004016 Expansion of coefficient of x^0 in f(x * q, q / x)^3 in powers of q^2 where f(,) is Ramanujan's general theta function. - _Michael Somos_, Jan 01 2012
%F A004016 G.f. A(x) satisfies 0 = f(A(x), A(x^2), A(x^4)) where f(u, v, w) = u^2 - 3*v^2 - 2*u*w + 4*w^2. - _Michael Somos_, Jun 11 2004
%F A004016 G.f. A(x) satisfies 0 = f(A(x), A(x^2), A(x^3), A(x^6)) where f(u1, u2, u3, u6) = (u1-u3) * (u3-u6) - (u2-u6)^2. - _Michael Somos_, May 20 2005
%F A004016 G.f. is a period 1 Fourier series which satisfies f(-1 / (3 t)) = 3^(1/2) (t/i) f(t) where q = exp(2 Pi i t). - _Michael Somos_, Sep 11 2007
%F A004016 G.f. A(x) satisfies A(x) + A(-x) = 2 * A(x^4), from Ramanujan.
%F A004016 G.f.: 1 + 6 * Sum_{k>0} x^k / (1 + x^k + x^(2*k)). - _Michael Somos_, Oct 06 2003
%F A004016 G.f.: Sum_( q^(n^2+n*m+m^2) ) where the sum (for n and m) extends over the integers. - _Joerg Arndt_, Jul 20 2011
%F A004016 G.f.: theta_3(q) * theta_3(q^3) + theta_2(q) * theta_2(q^3) = (eta(q^(1/3))^3 + 3 * eta(q^3)^3) / eta(q).
%F A004016 G.f.: 1 + 6*Sum_{n>=1} x^(3*n-2)/(1-x^(3*n-2)) - x^(3*n-1)/(1-x^(3*n-1)). - _Paul D. Hanna_, Jul 03 2011
%F A004016 a(3*n + 2) = 0, a(3*n) = a(n), a(3*n + 1) = 6 * A033687(n). - _Michael Somos_, Jul 16 2005
%F A004016 a(2*n + 1) = 6 * A033762(n), a(4*n + 2) = 0, a(4*n) = a(n), a(4*n + 1) = 6 * A112604(n), a(4*n + 3) = 6 * A112595(n). - _Michael Somos_, May 17 2013
%F A004016 a(n) = 6 * A002324(n) if n>0. a(n) = A005928(3*n).
%F A004016 Euler transform of A192733. - _Michael Somos_, Mar 12 2012
%F A004016 a(n) = (-1)^n * A180318(n). - _Michael Somos_, Sep 14 2015
%F A004016 Asymptotic mean: Limit_{m->oo} (1/m) * Sum_{k=1..m} a(k) = 2*Pi/sqrt(3) = 3.627598... (A186706). - _Amiram Eldar_, Oct 15 2022
%e A004016 G.f. = 1 + 6*x + 6*x^3 + 6*x^4 + 12*x^7 + 6*x^9 + 6*x^12 + 12*x^13 + 6*x^16 + ...
%e A004016 Theta series of A_2 on the standard scale in which the minimal norm is 2:
%e A004016 1 + 6*q^2 + 6*q^6 + 6*q^8 + 12*q^14 + 6*q^18 + 6*q^24 + 12*q^26 + 6*q^32 + 12*q^38 + 12*q^42 + 6*q^50 + 6*q^54 + 12*q^56 + 12*q^62 + 6*q^72 + 12*q^74 + 12*q^78 + 12*q^86 + 6*q^96 + 18*q^98 + 12*q^104 + 12*q^114 + 12*q^122 + 12*q^126 + 6*q^128 + 12*q^134 + 12*q^146 + 6*q^150 + 12*q^152 + 12*q^158 + ...
%p A004016 A004016 := proc(n)
%p A004016     local a,j ;
%p A004016     a := A033716(n) ;
%p A004016     for j from 0 to n/3 do
%p A004016         a := a+A089800(n-1-3*j)*A089800(j) ;
%p A004016     end do:
%p A004016     a;
%p A004016 end proc:
%p A004016 seq(A004016(n),n=0..49) ; # _R. J. Mathar_, Feb 22 2021
%t A004016 a[ n_] := If[ n < 1, Boole[ n == 0 ], 6 DivisorSum[ n, KroneckerSymbol[ #, 3] &]]; (* _Michael Somos_, Nov 08 2011 *)
%t A004016 a[ n_] := SeriesCoefficient[ (QPochhammer[ q]^3 + 9 q QPochhammer[ q^9]^3) / QPochhammer[ q^3], {q, 0, n}]; (* _Michael Somos_, Nov 13 2014 *)
%t A004016 a[ n_] := SeriesCoefficient[ EllipticTheta[ 3, 0, q] EllipticTheta[ 3, 0, q^3] + EllipticTheta[ 2, 0, q] EllipticTheta[ 2, 0, q^3], {q, 0, n}]; (* _Michael Somos_, Nov 13 2014 *)
%t A004016 a[ n_] := Length @ FindInstance[ x^2 + x y + y^2 == n, {x, y}, Integers, 10^9]; (* _Michael Somos_, Sep 14 2015 *)
%t A004016 terms = 81; f[q_] = LatticeData["A2", "ThetaSeriesFunction"][-I Log[q]/Pi]; s = Series[f[q], {q, 0, 2 terms}]; CoefficientList[s, q^2][[1 ;; terms]] (* _Jean-François Alcover_, Jul 04 2017 *)
%o A004016 (PARI) {a(n) = my(A, p, e); if( n<1, n==0, A = factor(n); 6 * prod( k=1, matsize(A)[1], [p, e] = A[k, ]; if( p==3, 1, p%3==1, e+1, 1-e%2)))}; /* _Michael Somos_, May 20 2005 */ /* Editor's note: this is the most efficient program */
%o A004016 (PARI) {a(n) = if( n<0, 0, polcoeff( 1 + 6 * sum( k=1,n, x^k / (1 + x^k + x^(2*k)), x * O(x^n)), n))}; /* _Michael Somos_, Oct 06 2003 */
%o A004016 (PARI) {a(n) = if( n<1, n==0, 6 * sumdiv( n,d, kronecker( d, 3)))}; /* _Michael Somos_, Mar 16 2005 */
%o A004016 (PARI) {a(n) = if( n<1, n==0, 6 * sumdiv( n,d, (d%3==1) - (d%3==2)))}; /* _Michael Somos_, May 20 2005 */
%o A004016 (PARI) {a(n) = my(A); if( n<0, 0, n*=3; A = x * O(x^n); polcoeff( (eta(x + A)^3  + 3 * x * eta(x^9 + A)^3) / eta(x^3 + A), n))}; /* _Michael Somos_, May 20 2005 */
%o A004016 (PARI) {a(n) = if( n<1, n==0, qfrep([ 2, 1; 1, 2], n, 1)[n] * 2)}; /* _Michael Somos_, Jul 16 2005 */
%o A004016 (PARI) {a(n) = if( n<0, 0, polcoeff( 1 + 6 * sum( k=1, n, x^(3*k - 2) / (1 - x^(3*k - 2)) - x^(3*k - 1) / (1 - x^(3*k - 1)), x * O(x^n)), n))} /* _Paul D. Hanna_, Jul 03 2011 */
%o A004016 (SageMath) ModularForms( Gamma1(3), 1, prec=81).0 ; # _Michael Somos_, Jun 04 2013
%o A004016 (Magma) Basis( ModularForms( Gamma1(3), 1), 81) [1]; /* _Michael Somos_, May 27 2014 */
%o A004016 (Magma) L := Lattice("A",2); A<q> := ThetaSeries(L, 161); A; /* _Michael Somos_, Nov 13 2014 */
%o A004016 (Python)
%o A004016 from math import prod
%o A004016 from sympy import factorint
%o A004016 def A004016(n): return 6*prod(e+1 if p%3==1 else int(not e&1) for p, e in factorint(n).items() if p != 3) if n else 1 # _Chai Wah Wu_, Nov 17 2022
%Y A004016 Cf. A002324, A003051, A003215, A005881, A005882, A005928, A008458, A033685, A033687, A038587-A038591, etc.
%Y A004016 See also A035019.
%Y A004016 Cf. A000007, A000122, A004015, A008444, A008445, A008446, A008447, A008448, A008449 (Theta series of lattices A_0, A_1, A_3, A_4, ...), A186706.
%K A004016 nonn,nice,easy
%O A004016 0,2
%A A004016 _N. J. A. Sloane_
