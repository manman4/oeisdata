%I A388851 #63 Sep 28 2025 13:58:20
%S A388851 4,6,8,9,10,16,18,20,24,25,28,30,32,35,36,45,49,50,54,63,64,70,72,77,
%T A388851 80,81,96,98,100,112,120,121,125,126,128,140,144,150,162,169,175,176,
%U A388851 180,196,200,216,221,225,231,242,243,245,252,256,270,280,288,289,294,308
%N A388851 Numbers c such that a!b!c! is a perfect square for some 1 <= a < b < c.
%C A388851 It is numerically convenient to work with A055204(a) c!/b! rather than a! b! c!, which is equivalent for the purpose of testing square-ness. In all known examples, b is c-1, c-2, or c-3. This is the set F_3 studied in [Erdős-Graham 76], except for the number 1. After omitting the square numbers, it is the set D_3. Contains any number of the form A055204(a) n^2 for n large enough, since in this case a! (A055204(a) n^2-1)! (A055204(a) n^2)! will be a perfect square. This is conjectured to be the dominant contribution to the set [Erdős-Graham 76], [Erdos problem #374]. Also contains any number of the form vy^2+1 if a! = uv, and x and y are sufficiently large solutions to the Pell-type equation ux^2-vy^2=1, since in this case a! (vy^2-1)! (vy^2+1)! will be a perfect square.
%C A388851 b >= (the largest prime <= c) = A007917(c). - _David A. Corneth_, Sep 22 2025
%C A388851 a < A151799(c). - _Chai Wah Wu_, Sep 22 2025
%H A388851 Chai Wah Wu, <a href="/A388851/b388851.txt">Table of n, a(n) for n = 1..2855</a> (terms 1..230 from Hugo Pfoertner, terms 231..2222 from David A. Corneth)
%H A388851 Thomas Bloom, <a href="https://www.erdosproblems.com/374">Problem 374</a>, Erdős Problems.
%H A388851 David A. Corneth, <a href="/A388851/a388851.gp.txt">PARI program</a>
%H A388851 P. Erdős and R. L. Graham, <a href="https://old.renyi.hu/~p_erdos/1976-25.pdf">On products of factorials</a>, Bull. Inst. Math. Acad. Sinica 4 (1976), pp. 337-355.
%H A388851 P. Erdős and R. L. Graham, <a href="https://fanchung.ucsd.edu/ron/papers/80_11_number_theory.pdf">Old and new problems and results in combinatorial number theory</a>, Monographies de L'Enseignement Mathématique (1980).
%e A388851 10 is in the sequence because 6! 7! 10! = (6! * 7!)^2 is a perfect square, or equivalently A055204(a) 10!/7! = 60^2 is a perfect square.
%t A388851 A388851Q[c_] := CompositeQ[c] && Catch[Do[If[IntegerQ[Sqrt[a!*c!/b!]], Throw[True]], {b, c-1, NextPrime[c, -1], -1}, {a, b-1, 1, -1}]; False];
%t A388851 Select[Range[300], A388851Q] (* _Paolo Xausa_, Sep 24 2025 *)
%o A388851 (Python)
%o A388851 import math
%o A388851 def is_square(n):
%o A388851     r = math.isqrt(n)
%o A388851     return r * r == n
%o A388851 results = []
%o A388851 for c in range(1, 101):
%o A388851     for a in range(1, c):
%o A388851         for b in range(a+1, c):
%o A388851             val = math.factorial(c) // math.factorial(b)
%o A388851             val *= math.factorial(a) # can also extract squarefree part here if desired
%o A388851             if is_square(val):
%o A388851                 results.append(c)
%o A388851                 break
%o A388851         else: continue
%o A388851         break
%o A388851 (Python)
%o A388851 from itertools import count, islice
%o A388851 from collections import Counter
%o A388851 from sympy import factorint, isprime
%o A388851 def A388851_gen(): # generator of terms
%o A388851     g, p, r = [Counter()], 0, {tuple():0}
%o A388851     for c in count(2):
%o A388851         d = Counter(i for i, j in (g[-1]+Counter(factorint(c))).items() if j&1)
%o A388851         g.append(d)
%o A388851         if (t:=tuple(sorted(d.keys()))) not in r:
%o A388851             r[t] = c-1
%o A388851         for b in range(c-2,p,-1):
%o A388851             e = tuple(sorted(i for i, j in (d+g[b]).items() if j&1))
%o A388851             if e in r and r[e]<b:
%o A388851                 yield c
%o A388851                 break
%o A388851         if isprime(c):
%o A388851             p = c-2
%o A388851 A388851_list = list(islice(A388851_gen(),60)) # _Chai Wah Wu_, Sep 24 2025
%o A388851 (PARI) is_a388851(c) = forstep(b=c-1,precprime(c-1),-1, forstep(a=b-1,1,-1, my(p=a!*b!*c!); if(issquare(p), return(1)))); 0 \\ _Hugo Pfoertner_, Sep 21 2025, including comment of _David A. Corneth_, Sep 22 2025
%o A388851 (PARI) \\ See Corneth link
%Y A388851 Cf. A055204, A151799.
%K A388851 nonn,changed
%O A388851 1,1
%A A388851 _Terence Tao_, Sep 21 2025
