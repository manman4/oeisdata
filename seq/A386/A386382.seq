%I A386382 #26 Sep 26 2025 22:04:38
%S A386382 1,1,3,11,47,242,1447,9930,76964,666339,6379657,66988527,765926227,
%T A386382 9477113482,126219959400
%N A386382 Total number of runs in all heapable permutations of length n.
%C A386382 A permutation of [1..n] is heapable if it can be inserted, one element at a time, into a binary min-heap without violating the heap property.
%C A386382 A run in a permutation is a maximal contiguous subsequence that is either strictly increasing or strictly decreasing. For example, the permutation (1,3,2,4) has runs (1,3), (3,2), (2,4), hence 3 runs.
%C A386382 This sequence counts the total number of runs over all heapable permutations of length n.
%H A386382 Benjamin Chen, Michael Cho, Mario Tutuncu-Macias, and Tony Tzolov, <a href="https://doi.org/10.1016/j.dam.2023.01.025">Efficient methods of calculating the number of heapable permutations</a>, Discrete Applied Mathematics Volume 331, 31 May 2023, Pages 126-137.
%H A386382 Manolopoulos Panagiotis, <a href="/A386382/a386382.py.txt">Python Program</a>
%e A386382 For n=4, the heapable permutations are:
%e A386382   (1,2,3,4): always increasing => 1 run.
%e A386382   (1,3,2,4): 1->3 (up), 3->2 (down), 2->4 (up) => 3 runs.
%e A386382   (1,2,4,3): 1->2 (up), 2->4 (up), 4->3 (down) => 2 runs.
%e A386382   (1,4,2,3): 1->4 (up), 4->2 (down), 2->3 (up) => 3 runs.
%e A386382   (1,3,4,2): 1->3 (up), 3->4 (up), 4->2 (down) => 2 runs.
%e A386382 So among the 5 heapable permutations of length 4:
%e A386382   1 permutation has 1 run,
%e A386382   2 permutations have 2 runs,
%e A386382   2 permutations have 3 runs,
%e A386382 for a total of 11 runs.
%Y A386382 Cf. A336282 (number of heapable permutations), A388139 (total number fixed points), A388136 (total number of cycles).
%K A386382 nonn,more
%O A386382 1,3
%A A386382 _Manolopoulos Panagiotis_, Sep 16 2025
%E A386382 a(11)-a(15) from _Sean A. Irvine_, Sep 26 2025
