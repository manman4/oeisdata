%I A386603 #14 Oct 31 2025 10:24:28
%S A386603 2,3,11,47,107,83,167,293,227,503,677,887,983,1217,1877,1487,2243,
%T A386603 3797,2477,2273,4373,3167,3947,4457,4703,5507,6047,5843,7577,8123,
%U A386603 10457,5297,12437,12227,13697,10853,15077,13187,9833,12473,20543,15923,20327,22343,18233
%N A386603 Smallest prime p for which there are exactly n smaller primes q such that p - q is a perfect square.
%C A386603 Smallest prime p for which A386600(A000720(p)) = n.
%e A386603 47 is the smallest prime p for which there are exactly 3 smaller primes q such that p - q is a perfect square: 47 - 11 = 36 = 6^2, 47 - 31 = 16 = 4^2, 47 - 43 = 4 = 2^2. Hence, a(3) = 47.
%p A386603 A386603:=proc(N) # To get the terms a(0) to a(n)
%p A386603     local a,c,i,k,p,v;
%p A386603     v:=Vector(N+1,-1);
%p A386603     c:=0;
%p A386603     for k while c<=N do
%p A386603         a:=0;
%p A386603         p:=ithprime(k);
%p A386603         for i to k-1 do
%p A386603             if issqr(p-ithprime(i)) then
%p A386603                 a:=a+1
%p A386603             fi
%p A386603         od;
%p A386603         if a<=N and v[a+1]=-1 then
%p A386603             v[a+1]:=p;
%p A386603             c:=c+1
%p A386603         fi
%p A386603     od;
%p A386603     return op(convert(v,list))	
%p A386603 end proc;
%p A386603 A386603(44);
%t A386603 a[n_]:=Module[{p=2},While[q=Prime[Range[PrimePi[p-1]]];Total[Boole[IntegerQ/@Surd[p-q,2]]]!=n,p=NextPrime[p]];p];Array[a,30,0] (* _James C. McMahon_, Oct 31 2025 *)
%o A386603 (PARI) isok(k, n) = my(vp=primes(k)); sum(i=1, k-1, issquare(vp[k] - vp[i])) == n;
%o A386603 a(n) = my(k=1); while (!isok(k,n), k++); prime(k); \\ _Michel Marcus_, Oct 27 2025
%Y A386603 Cf. A000040, A000290, A000720, A065376, A065377, A386600.
%K A386603 nonn,new
%O A386603 0,1
%A A386603 _Felix Huber_, Oct 27 2025
