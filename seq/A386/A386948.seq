%I A386948 #7 Sep 08 2025 22:24:03
%S A386948 1,1,-2,2,1,-1,-1,3,-4,2,-1,-1,2,-3,-5,4,1,-1,-1,-1,-1,-6,2,-2,3,-1,
%T A386948 -1,3,-10,2,-1,-1,-1,-1,-1,-1,-1,-1,-3,3,-3,-10,4,-1,-1,-1,-4,2,-5,
%U A386948 -13,3,-1,-1,-1,-16,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-10,5
%N A386948 Let s = A386482 and let D = s(n)-s(n-1); a(n) = position i of |D| in row s(n-1) of A121998, multiplied by sign(D).
%C A386948 Let R(x,i) be the i-th term in row x of A121998; i.e., the union of p*[1..x/p] for all p | x = { m <= x : gcd(m,x)>1 }, where i <= x - phi(x); i.e., i <= A051953(x), and phi = A000010.
%C A386948 Sequence s = A386482 finds a candidate k = s(n-1) - R(s(n-1),i), but if no k != a(j), j < n is found, then if s(n-1) is not a prime power, k = s(n-1) + R(s(n-1),i) for some i. If we permit R(x,i) to extend indefinitely; i.e., { m : gcd(m,x)>1 }, then we may include prime powers s(n-1).
%C A386948 For prime powers s(n-1) = p*m, k = p*(m-i) unless no positive k such that k != a(j), j < n is true, then k = p*(m+i) for some i.
%C A386948 This is the sequence of indices i, a measure of depth of search for a hit among valid candidates for s(n).
%C A386948 From the standpoint of a greedy approach is setting i = 1, hence, s(n) = s(n-1) - R(s(n-1),1) = s(n-1) - lpf(s(n-1)) where lpf = A020639 is the least prime factor. In this sequence such is indicated by a(n) = -1.
%C A386948 Let Q(n) be the number of candidates k tried until and including s(n) = k. Then:
%C A386948   for a(n) < 0, Q(n) = -1 * a(n),
%C A386948   for a(n) > 0, Q(n) = s(n-1) - phi(s(n-1)) + a(n) - 2 = A051953(s(n-1)) + a(n) - 2.
%H A386948 Michael De Vlieger, <a href="/A386948/b386948.txt">Table of n, a(n) for n = 3..10000</a>
%H A386948 Michael De Vlieger, <a href="/A386948/a386948.png">Logarithmic scatterplot of sign(a(n)) * log_10 |a(n)|</a>, n = 3..2^16, showing negative values in red and positive in green.
%e A386948 Table of values of a(n), s(n), and d(n) = -A387075(n) + A387079(n) for select n. Asterisks denote the emergence of a term R(s(n-1),i) indivisible by lpf(s(n-1)); i.e., n in A387081. The last column indicates R(s(n-1),i) in brackets, however, "m" indicates a multiple of prime factor p | s(n-1) when s(n-1) is a prime power. Minus represents subtraction of indicated R(s(n-1),i) from s(n-1), and plus indicates addition of indicated R(s(n-1),i) to s(n-1).
%e A386948  n  s(n) a(n) Q(n)  d(n)     row s(n-1) of A121998
%e A386948 ----------------------------------------------------
%e A386948  3    4    1    2    -4      m{[2]}
%e A386948  4    6    1    3    -4      m{[2],4}
%e A386948  5    3   -2    2     1   *  -{2,[3],4,6}
%e A386948  6    9    2    3    -9      m{2,[3],4,...}
%e A386948  7   12    1    4    -6      m{[4],5,6,...}
%e A386948  8   10   -1    1     0      -{[2],3,4,6,8,9,12}
%e A386948  9    8   -1    1     0      -{[2],4,5,6,8,10}
%e A386948 10   14    3    7    -8      m{2,4,[6],8,10,...}
%e A386948 11    7   -4    4     5   *  -{2,4,6,[7],8,10,12,14}
%e A386948 12   21    2    3   -21      m{2,[3],4,...}
%e A386948 41   35   -3    3     3   *  -{2,4,[5],6,8,10,..,40}
%e A386948 42   45    3   12   -15      +{5,7,[10],14,20,21,25,28,30,35}
%e A386948 a(3) = 1 since s(3) = 4 = 2+2 is greater than s(2) = 2, and 2 is the first term in row 2 of A121998.
%e A386948 a(4) = 1 since s(4) = 6 = 4+2 is greater than s(3) = 4, and 2 is the first term in row 4 of A121998.
%e A386948 a(5) = -2 since s(5) = 3 = 6-3 is less than s(4) = 6, and 3 is the second term in row 6 of A121998.
%e A386948 a(6) = 2 since s(6) = 9 = 3+2*3 is greater than s(5) = 3, moving 3*m, m=2 above s(5), a prime power.
%e A386948 a(7) = 1 since s(7) = 12 = 9+3 is greater than s(6) = 9, moving 3*m, m=1 above s(6), a prime power.
%e A386948 s(8) = -1 since s(8) = 10 = 12-2, moving 2 down from s(7), where 2 is the first term in row 12 of A121998.
%e A386948 s(9) = -1 since s(9) = 8 = 10-2, moving 2 down from s(8), where 2 is the first term in row 10 of A121998.
%e A386948 s(10) = 3 since s(10) = 14 = 8+6, moving 2*m, m=3 above s(9), a prime power.
%e A386948 s(11) = -4 since s(11) = 7 = 14-7, moving 7 down from s(10), where 7 is the fourth term in row 14 of A121998.
%e A386948 s(42) = 3 since s(42) = 45 = 35+10, moving 10 up from s(41) = 35, where 10 is the third term in row 35 of A121998. To get to 45 from 35, we had to consume all the terms in row 35 of A121998, except for 35 itself (which is forbidden) thus 9 candidates, then we had to consume 3 candidates in the same row above 35, to hit 35+10=45. Thus, we consumed a total of 12 candidates to reach a solution for s(42).
%t A386948 s = Import["https://oeis.org/A386482/b386482.txt", "Data"][[;; , -1 ]]; j = 2;
%t A386948 Reap[Do[
%t A386948   R = Union@ Flatten@ First@ Outer[#2*Range[#1/#2] &, {#1}, {#2}] & @@
%t A386948     {j, FactorInteger[j][[;; , 1]] };
%t A386948   If[PrimePowerQ[j], Sow[(s[[n]] - j)/FactorInteger[j][[1, 1]] ],
%t A386948   Sow[Sign[#]*FirstPosition[R, Abs[#] ][[1]]] &[s[[n]] - j] ];
%t A386948   j = s[[n]], {n, 3, 120}]
%t A386948 ][[-1, 1]]
%Y A386948 Cf. A000010, A051953, A121998, A386482, A387075, A387079, A387081.
%K A386948 sign
%O A386948 3,3
%A A386948 _Michael De Vlieger_, Aug 21 2025
