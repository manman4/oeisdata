%I A387618 #14 Sep 28 2025 15:42:29
%S A387618 1,2,1,2,3,1,2,1,5,6,1,2,3,2,7,1,1,5,3,2,9,10,1,2,3,1,6,2,5,11,2,1,6,
%T A387618 2,1,2,1,13,1,2,2,5,5,7,1,1,7,14,15,1,2,1,2,6,1,3,3,5,14,1,1,2,3,5,1,
%U A387618 2,1,10,3,1,2,10,2,19,1,2,3,2,1,2,3,2,1,17,2,5,21,22,1,2,1,3,6
%N A387618 Smallest positive integer k such that there exists an algebraic integer in Q(sqrt(D)) of norm -k, where D = A005117(n) is the n-th squarefree number.
%C A387618 If D = A005117(n) is 2 or 3 (mod 4), then a(n) is the smallest positive integer k of the form D*X^2 - Y^2 for some integers X and Y.  Otherwise if D = A005117(n) is 1 (mod 4), then a(n) is the smallest positive integer k of the form ((D-1)/4)*X^2 - X*Y - Y^2 for some integers X and Y.
%H A387618 Robin Visser, <a href="/A387618/b387618.txt">Table of n, a(n) for n = 2..10000</a>
%H A387618 Se Wook Jang and Byeong Moon Kim, <a href="https://doi.org/10.1016/j.jnt.2015.06.003">A refinement of the Dress-Scharlau theorem</a>, J. Number Theory 158 (2016), 234-243.
%H A387618 Magdaléna Tinková and Paul Voutier, <a href="https://doi.org/10.1016/j.jnt.2019.11.005">Indecomposable integers in real quadratic fields</a>, J. Number Theory 212 (2020), 458-482.
%F A387618 a(n) = 1 if and only if A005117(n) is a member of the sequence A003654.
%F A387618 a(n) < 2*sqrt(A005117(n)) for all n > 1.
%e A387618 For n = 2, the field Q(sqrt(A005117(2))) = Q(sqrt(2)) contains the integral element 1 + sqrt(2) which has norm -1, thus a(2) = 1.
%e A387618 For n = 3, the field Q(sqrt(A005117(3))) = Q(sqrt(3)) contains the integral element 1 + sqrt(3) which has norm -2, but contains no unit of norm -1, thus a(3) = 2.
%e A387618 For n = 4, the field Q(sqrt(A005117(4))) = Q(sqrt(5)) contains the integral element 1/2 + sqrt(5)/2 which has norm -1, thus a(4) = 1.
%o A387618 (SageMath)
%o A387618 def a(n):
%o A387618     D = [d for d in range(2*n) if Integer(d).is_squarefree()][n-1]
%o A387618     K.<a> = QuadraticField(D); UK = K.unit_group()
%o A387618     if UK.fundamental_units()[0].norm() == -1: return 1
%o A387618     idls = K.ideals_of_bdd_norm(D)
%o A387618     for (k,I) in [(x,y) for x in range(1, D) for y in idls[x]]:
%o A387618         ans = -(I.gens_reduced()[0].norm())
%o A387618         if I.is_principal() and ans > 0: return ans
%Y A387618 Cf. A003654, A005117, A387207.
%K A387618 nonn
%O A387618 2,2
%A A387618 _Robin Visser_, Sep 03 2025
