%I A387686 #12 Sep 14 2025 19:38:59
%S A387686 0,1,2,3,4,5,1,2,6,7,1,3,8,9,2,3,10,1,5,11,2,4,1,6,12,13,1,7,2,5,3,4,
%T A387686 14,1,8,2,6,15,3,5,16,2,7,17,1,2,3,1,10,3,6,4,5,18,1,11,19,3,7,2,9,4,
%U A387686 6,1,12,20,3,8,2,10,21,1,13,4,7,1,2,5,5,6,22,2,11,3,9,1,14,23,4,8,1,2
%N A387686 Irregular array, read by rows. Let S be the additive monoid generated by the square roots of positive integers, sorted in increasing order.  Write S(n) as the sum of terms b_k * sqrt(c_k) where b_k are integers, c_k are distinct and squarefree. Row n of the array consists of b_k^2 * c_k, sorted in increasing order.
%H A387686 Robert Israel, <a href="/A387686/b387686.txt">Table of n, a(n) for n = 1..11605</a> (first 4000 rows, flattened)
%e A387686 S(166) = 2 + 3*sqrt(2) = 2*sqrt(1) + 3*sqrt(2), so row 166 is [4, 18].
%e A387686 The first 10 rows are
%e A387686  0;
%e A387686  1;
%e A387686  2;
%e A387686  3;
%e A387686  4;
%e A387686  5;
%e A387686  1, 2;
%e A387686  6;
%e A387686  7;
%e A387686  1, 3.
%p A387686 N:= 5: # for terms before the first appearance of N+1 in S
%p A387686 P[0]:= {0}:
%p A387686 for i from 1 to N do P[i]:= {} od:
%p A387686 for x from 1 to (N+1)^2 do
%p A387686   for i from 0 to N do SP[i]:= {} od:
%p A387686   if not numtheory:-issqrfree(x) then next fi;
%p A387686   for j from 1 to floor((N+1)/sqrt(x)) do
%p A387686     for i from 0 to floor(N +1 - j*sqrt(x)) do
%p A387686       for y in P[i] do
%p A387686         z:= y + j*sqrt(x);
%p A387686         iz:= floor(z);
%p A387686         if iz <= N then SP[iz]:= SP[iz] union {z} fi
%p A387686   od od od;
%p A387686   for i from 0 to N do P[i]:= P[i] union SP[i] od;
%p A387686 od;
%p A387686 for i from 0 to N do
%p A387686   P[i]:= sort(convert(P[i],list),(a,b) -> is(a<b))
%p A387686 od:
%p A387686 PP:= [seq(op(P[i]),i=0..N)]:
%p A387686 unpack:= proc(s)
%p A387686   if s::`+` then sort(map(t -> t^2, convert(s,list))) else [s^2] fi
%p A387686 end proc:
%p A387686 for t in PP do unpack(t) od;
%K A387686 nonn,tabf
%O A387686 1,3
%A A387686 _Robert Israel_, Sep 05 2025
