%I A387810 #20 Oct 10 2025 10:20:53
%S A387810 1,2,6,15,35,28,26,39,33,22,20,45,21,14,10,55,77,63,60,58,203,189,186,
%T A387810 184,161,147,144,142,355,345,342,338,325,315,309,206,202,303,297,286,
%U A387810 284,213,207,115,110,108,93,155,145,116,114,111,185,175,168,166,415,405
%N A387810 Lexicographically earliest infinite sequence of distinct positive numbers such that, for n > 3, a(n) is the largest number less than a(n-1) that shares a factor with a(n-1) and is coprime to a(n-2), or if no such number exists then a(n) is the smallest number greater than a(n-1) that shares a factor with a(n-1) and is coprime to a(n-2).
%C A387810 Similar to A336957, to ensure the sequence is infinite a(n) must be chosen such that it has a prime factor that is not a factor of a(n-1), therefore, other than 2, no primes can appear.
%C A387810 Overall the terms of the sequence progress in large steps due to terms appearing that are a small multiple of a large prime factor, the small multiple having a factor in common with a(n-1). This forces the next term to be a multiple of the large prime.
%C A387810 Of the terms studied the only fixed points are 1, 2 and 14; it is likely no more exist.
%H A387810 Chai Wah Wu, <a href="/A387810/b387810.txt">Table of n, a(n) for n = 1..935</a> (terms 1..400 from Scott R. Shannon)
%e A387810 a(6) = 28 as 28 shares a factor with a(5) = 35, is coprime to a(4) = 15, and has a prime factor, namely 2, that is not a factor of a(5) = 35.
%o A387810 (Python)
%o A387810 from math import gcd
%o A387810 from itertools import count, islice
%o A387810 from sympy import primefactors
%o A387810 def A387810_gen(): # generator of terms
%o A387810     k,m,mset,c = 2, 6, {1,2,6}, 3
%o A387810     yield from (1,2,6)
%o A387810     while True:
%o A387810         r = set(primefactors(m))
%o A387810         for i in range(m-1,c-1,-1):
%o A387810             if i not in mset and gcd(i,m)>1 and gcd(i,k)==1 and not set(primefactors(i))<=r:
%o A387810                 yield i
%o A387810                 break
%o A387810         else:
%o A387810             for i in count(max(c,m+1)):
%o A387810                 if i not in mset and gcd(i,m)>1 and gcd(i,k)==1 and not set(primefactors(i))<=r:
%o A387810                     yield i
%o A387810                     break
%o A387810         k, m = m, i
%o A387810         mset.add(i)
%o A387810         while c in mset:
%o A387810             mset.remove(c)
%o A387810             c += 1
%o A387810 A387810_list = list(islice(A387810_gen(),50)) # _Chai Wah Wu_, Sep 15 2025
%Y A387810 Cf. A336957, A387838, A387731, A386482, A387758, A387759, A336957, A387231.
%K A387810 nonn
%O A387810 1,2
%A A387810 _Scott R. Shannon_, Sep 08 2025
