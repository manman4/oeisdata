%I A387731 #15 Sep 15 2025 18:59:54
%S A387731 1,2,3,4,9,8,15,14,5,6,25,24,35,34,21,20,7,10,49,48,77,76,63,62,57,56,
%T A387731 51,50,39,38,33,32,27,26,45,44,65,64,55,54,11,12,121,120,143,142,117,
%U A387731 116,111,110,93,92,87,86,81,80,69,68,23,22,115,114,85,84,17
%N A387731 a(n) = n if n <= 3; thereafter a(n) is either the greatest number k < a(n-1) not already used such that gcd(k, a(n-1)) = 1 and gcd(k, a(n-2)) > 1, or if no such k exists then a(n) is the smallest number k > a(n-1) not already used such that gcd(k, a(n-1)) = 1 and gcd(k, a(n-2)) > 1.
%C A387731 This sequence is a variant of the Yellowstone permutation (A098550) inspired by A386482.
%C A387731 This sequence first differs from the Yellowstone permutation at n = 12, where a(12) = k = 24 is closer to a(11) = 25 than A064413(12) = 12 is.
%C A387731 Conjecture: this sequence is a permutation of the positive integers.
%H A387731 Rémy Sigrist, <a href="/A387731/b387731.txt">Table of n, a(n) for n = 1..10000</a>
%H A387731 Rémy Sigrist, <a href="/A387731/a387731.gp.txt">PARI program</a>
%e A387731 The first terms, alongside their p-adic valuations for small prime numbers p, are:
%e A387731   n   a(n)  p-adic valuation
%e A387731             2 3 5 7
%e A387731   --  ----  ----------------
%e A387731    1     1  .
%e A387731    2     2  1
%e A387731    3     3  . 1
%e A387731    4     4  2
%e A387731    5     9  . 2
%e A387731    6     8  3
%e A387731    7    15  . 1 1
%e A387731    8    14  1 . . 1
%e A387731    9     5  . . 1
%e A387731   10     6  1 1
%e A387731   11    25  . . 2
%e A387731   12    24  3 1
%e A387731   13    35  . . 1 1
%o A387731 (PARI) \\ See Links section.
%o A387731 (Python)
%o A387731 from math import gcd
%o A387731 from itertools import count, islice
%o A387731 def A387731_gen(): # generator of terms
%o A387731     k,m,mset,c = 2,3, {1,2,3}, 4
%o A387731     yield from (1,2,3)
%o A387731     while True:
%o A387731         for i in range(m-1,c-1,-1):
%o A387731             if i not in mset and gcd(i,m)==1 and gcd(i,k)>1:
%o A387731                 yield i
%o A387731                 break
%o A387731         else:
%o A387731             for i in count(max(c,m+1)):
%o A387731                 if i not in mset and gcd(i,m)==1 and gcd(i,k)>1:
%o A387731                     yield i
%o A387731                     break
%o A387731         k, m = m, i
%o A387731         mset.add(i)
%o A387731         while c in mset:
%o A387731             mset.remove(c)
%o A387731             c += 1
%o A387731 A387731_list = list(islice(A387731_gen(),65)) # _Chai Wah Wu_, Sep 10 2025
%Y A387731 Cf. A098550, A386482, A387621 (starting with k < a(n-2) instead of a(n-1)).
%K A387731 nonn
%O A387731 1,2
%A A387731 _Rémy Sigrist_, Sep 06 2025
