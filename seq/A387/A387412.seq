%I A387412 #16 Sep 03 2025 21:31:18
%S A387412 1,1,1,3,1,2,1,1,1,4,1,1,1,1,1,2,3,5,2,1,1,2,1,1,4,3,2,2,3,2,1,1,5,1,
%T A387412 3,1,2,3,2,3,4,4,3,1,3,3,1,4,2,1,1,1,2,1,1,1,6,1,3,1,1,2,1,2,1,1,4,2,
%U A387412 3,1,3,2,4,1,1,1,3,1,2,2,2,2,3,1,2,2,2,3,1,2,4,2,6,2,3,1,4,1,1,3,5,1,3,2,3
%N A387412 The length of the maximal common prefix of the binary expansions of n and A003961(n), where A003961 is fully multiplicative with a(p) = nextprime(p).
%H A387412 Antti Karttunen, <a href="/A387412/b387412.txt">Table of n, a(n) for n = 1..65537</a>
%H A387412 <a href="/index/Bi#binary">Index entries for sequences related to binary expansion of n</a>.
%H A387412 <a href="/index/Pri#prime_indices">Index entries for sequences related to prime indices in the factorization of n</a>.
%F A387412 a(n) = (1+A000523(n)) - A387413(n).
%o A387412 (PARI)
%o A387412 A003961(n) = { my(f = factor(n)); for (i=1, #f~, f[i, 1] = nextprime(f[i, 1]+1)); factorback(f); };
%o A387412 A387412(n) = { my(a=binary(n), b=binary(A003961(n)), i=1); while(i<=#a,if(a[i]!=b[i],return(i-1)); i++); (#a); };
%o A387412 (Python)
%o A387412 from os.path import commonprefix
%o A387412 from math import prod
%o A387412 from sympy import factorint, nextprime
%o A387412 def A387412(n): return len(commonprefix([bin(n)[2:],bin(prod(nextprime(p)**e for p, e in factorint(n).items()))[2:]])) # _Chai Wah Wu_, Sep 03 2025
%Y A387412 Cf. A000523, A003961, A387413.
%Y A387412 Cf. also A387422.
%K A387412 nonn
%O A387412 1,4
%A A387412 _Antti Karttunen_, Sep 01 2025
